<Page x:Class="Safety_Wheel.Pages.Teacher.TeacherMainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"                 
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:viewModels="clr-namespace:Safety_Wheel.ViewModels"      
      xmlns:core="clr-namespace:Safety_Wheel.Converters"
      xmlns:views="clr-namespace:Safety_Wheel.Pages.Teacher"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      Title="HamburgerMenuPage">
    <!--xmlns:localViews="clr-namespace:Safety_Wheel.Views"

    <Page.DataContext>
        <viewModels:MainViewModel />
    </Page.DataContext>-->

    <Border Background="{StaticResource White}">
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
            <StackPanel.Resources>
                <core:SelectedItemToContentConverter x:Key="SelectedItemToContentConverter" />
                <!--  this is the template for the items (options too)  -->
                <core:MenuTypeToSingleVisibilityConverter x:Key="MenuTypeToSingleVisibilityConverter" />
                <core:MenuTypeToMultiVisibilityConverter x:Key="MenuTypeToMultiVisibilityConverter" />
                <DataTemplate x:Key="MenuItemTemplate" DataType="{x:Type viewModels:MenuItemViewModel}">
                    <Grid x:Name="RootGrid"
                          Height="48"
                          Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=CompactPaneLength}" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <ContentControl Grid.Column="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Content="{Binding Icon}"
                            Focusable="False" />
                        <TextBlock Grid.Column="1"
                       VerticalAlignment="Center"
                       FontSize="16"
                       Text="{Binding Label}" />
                    </Grid>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=IsPaneOpen}" Value="False">
                            <Setter TargetName="RootGrid" Property="ToolTip" Value="{Binding ToolTip, Mode=OneWay}" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>

                <!--  these are the templates for the view models  -->
                <DataTemplate DataType="{x:Type viewModels:TeacherSelectedStudViewModel}"/>
                <DataTemplate DataType="{x:Type viewModels:SelectedDateViewModel}"/>
                <DataTemplate DataType="{x:Type viewModels:CreateTestsViewModel}"/>
                <DataTemplate DataType="{x:Type viewModels:StatisticsViewModel}"/>

            </StackPanel.Resources>

            <mah:HamburgerMenu x:Name="MainMenuControl"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MainMenuItems}"
                               SelectedItem="{Binding SelectedMainMenuItem, Mode=TwoWay}"
                               SelectedIndex="2"
                               HamburgerVisibility="Visible"
                               Style="{StaticResource MainMenuStyle}" 
                               DockPanel.Dock="Left">
            </mah:HamburgerMenu>

            <mah:HamburgerMenu x:Name="PeopleMenuControl"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuItems}"
                               SelectedItem="{Binding SelectedStudent, Mode=TwoWay}"
                               OptionsItemsSource="{Binding MenuOptionItems}"
                               SelectedIndex="0"
                               HamburgerVisibility="Collapsed"
                               Grid.Column="0"
                               Style="{StaticResource PeoplesMenu}" 
                               DockPanel.Dock="Left">
            </mah:HamburgerMenu>

            <mah:HamburgerMenu x:Name="DatesMenuControl"
                               ItemInvoked="DatesMenuControl_ItemInvoked"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuDatesItems}"
                               SelectedItem="{Binding SelectedDate, Mode=TwoWay}"
                               SelectedIndex="0"
                               HamburgerVisibility="Collapsed"
                               Grid.Column="1"
                               Style="{StaticResource DatesMenu}"
                               DockPanel.Dock="Left">
                <mah:HamburgerMenu.Visibility>
                    <MultiBinding Converter="{StaticResource MenuTypeToMultiVisibilityConverter}" 
                                  ConverterParameter="Dates">
                        <Binding Path="SelectedMainMenuItem.Tag"/>
                        <Binding Path="MenuDatesItems.Count"/>
                    </MultiBinding>
                </mah:HamburgerMenu.Visibility>
            </mah:HamburgerMenu>
            <StackPanel Orientation="Horizontal">
                <mah:HamburgerMenu x:Name="AttemptsMenuControl"
                               DisplayMode="Overlay"
                               HamburgerWidth="48"
                               IsPaneOpen="True"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuAttemptsItems}"
                               SelectedItem="{Binding SelectedAttempt, Mode=TwoWay}"
                               SelectedIndex="0"
                               Style="{StaticResource AttemptsMenu}"
                                    DockPanel.Dock="Left">
                    <mah:HamburgerMenu.Visibility>
                        <MultiBinding Converter="{StaticResource MenuTypeToMultiVisibilityConverter}" 
                                  ConverterParameter="Attempts">
                            <Binding Path="SelectedMainMenuItem.Tag"/>
                            <Binding Path="MenuAttemptsItems.Count"/>
                        </MultiBinding>
                    </mah:HamburgerMenu.Visibility>

                    <mah:HamburgerMenu.ContentTemplate>
                        <DataTemplate>
                            <Grid/>
                        </DataTemplate>
                    </mah:HamburgerMenu.ContentTemplate>
                </mah:HamburgerMenu>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <Frame x:Name="FrameTeacher"
                            NavigationUIVisibility="Hidden"
                           Grid.Row="0"/>
                </Grid>
                

            </StackPanel>           
        </StackPanel>
    </Border>
</Page>