<Page x:Class="Safety_Wheel.Pages.Teacher.TeacherMainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"                 
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:viewModels="clr-namespace:Safety_Wheel.ViewModels"      
      xmlns:core="clr-namespace:Safety_Wheel.Converters"
      xmlns:views="clr-namespace:Safety_Wheel.Pages.Teacher"
      
      Title="HamburgerMenuPage">
    <!--xmlns:localViews="clr-namespace:Safety_Wheel.Views"

    <Page.DataContext>
        <viewModels:MainViewModel />
    </Page.DataContext>-->

    <Border Background="{StaticResource White}">
        <DockPanel>
            <DockPanel.Resources>
                <core:SelectedItemToContentConverter x:Key="SelectedItemToContentConverter" />
                <!--  this is the template for the items (options too)  -->
                <DataTemplate x:Key="MenuItemTemplate" DataType="{x:Type viewModels:MenuItemViewModel}">
                    <Grid x:Name="RootGrid"
                          Height="48"
                          Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=CompactPaneLength}" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <ContentControl Grid.Column="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Content="{Binding Icon}"
                            Focusable="False" />
                        <TextBlock Grid.Column="1"
                       VerticalAlignment="Center"
                       FontSize="16"
                       Text="{Binding Label}" />
                    </Grid>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=IsPaneOpen}" Value="False">
                            <Setter TargetName="RootGrid" Property="ToolTip" Value="{Binding ToolTip, Mode=OneWay}" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>

                <!--  these are the templates for the view models  -->
                <DataTemplate DataType="{x:Type viewModels:TeacherSelectedStudViewModel}"/>
                <DataTemplate DataType="{x:Type viewModels:SelectedDateViewModel}">
                    <views:TeacherViewingTestsPage DataContext="{Binding}" />
                </DataTemplate>

            </DockPanel.Resources>

            <mah:HamburgerMenu x:Name="PeopleMenuControl"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuItems}"
                               SelectedItem="{Binding SelectedStudent, Mode=TwoWay}"
                               OptionsItemsSource="{Binding MenuOptionItems}"
                               SelectedIndex="0"
                               HamburgerVisibility="Collapsed"
                               Grid.Column="0"
                               Style="{StaticResource PeoplesMenu}" 
                               DockPanel.Dock="Left">

            </mah:HamburgerMenu>

            <mah:HamburgerMenu x:Name="DatesMenuControl"
                               ItemInvoked="DatesMenuControl_ItemInvoked"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuDatesItems}"
                               SelectedItem="{Binding SelectedDate, Mode=TwoWay}"
                               SelectedIndex="0"
                               HamburgerVisibility="Collapsed"
                               Grid.Column="1"
                               Style="{StaticResource DatesMenu}"
                               DockPanel.Dock="Left">

                <!-- Контент для выбранной даты -->
                <mah:HamburgerMenu.Content>
                    <MultiBinding Converter="{StaticResource SelectedItemToContentConverter}">
                        <Binding Mode="OneWay"
                     Path="SelectedItem"
                     RelativeSource="{RelativeSource Self}" />
                    </MultiBinding>
                </mah:HamburgerMenu.Content>

                <mah:HamburgerMenu.ContentTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="48"/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>

                            <Border Grid.Row="0" Background="#FF444444">
                                <TextBlock HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           FontSize="24"
                           Foreground="White"
                           Text="{Binding DateTitle}" />
                            </Border>

                            <ContentControl Grid.Row="1"
                            Content="{Binding}"
                            Focusable="False" />
                        </Grid>
                    </DataTemplate>
                </mah:HamburgerMenu.ContentTemplate>
            </mah:HamburgerMenu>

            <Frame x:Name="FrameTeacher" 
                   Grid.Column="2"
                   NavigationUIVisibility="Hidden"
                    DockPanel.Dock="Left"/>
        </DockPanel>
    </Border>
</Page>