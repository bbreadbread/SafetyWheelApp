<Page x:Class="Safety_Wheel.Pages.Teacher.TeacherMainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"                 
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      xmlns:viewModels="clr-namespace:Safety_Wheel.ViewModels"      
      xmlns:core="clr-namespace:Safety_Wheel.Converters"
      xmlns:views="clr-namespace:Safety_Wheel.Pages.Teacher"
      
      Title="HamburgerMenuPage">
    <!--xmlns:localViews="clr-namespace:Safety_Wheel.Views"

    <Page.DataContext>
        <viewModels:MainViewModel />
    </Page.DataContext>-->

    <Border Background="{StaticResource MainBlue}">
        <Grid HorizontalAlignment="Left">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Grid.Resources>

                <core:SelectedItemToContentConverter x:Key="SelectedItemToContentConverter" />

                <!--  this is the template for the items (options too)  -->
                <DataTemplate x:Key="MenuItemTemplate" DataType="{x:Type viewModels:MenuItemViewModel}">
                    <Grid x:Name="RootGrid"
                          Height="48"
                          Background="Transparent">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=CompactPaneLength}" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <ContentControl Grid.Column="0"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Content="{Binding Icon}"
                            Focusable="False" />
                        <TextBlock Grid.Column="1"
                       VerticalAlignment="Center"
                       FontSize="16"
                       Text="{Binding Label}" />
                    </Grid>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type mah:HamburgerMenu}}, Path=IsPaneOpen}" Value="False">
                            <Setter TargetName="RootGrid" Property="ToolTip" Value="{Binding ToolTip, Mode=OneWay}" />
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>

                <!--  these are the templates for the view models  -->
                <DataTemplate DataType="{x:Type viewModels:TeacherSelectedStudViewModel}">
                    <views:TeacherSelectedStudPage DataContext="{Binding}" />
                </DataTemplate>

                <DataTemplate DataType="{x:Type viewModels:TeacherViewingTestsViewModel}">
                    <views:TeacherViewingTestsPage DataContext="{Binding}" />
                </DataTemplate>

            </Grid.Resources>

            <mah:HamburgerMenu x:Name="PeopleMenuControl"
                               DisplayMode="CompactInline"
                               IsPaneOpen="False"
                               ItemTemplate="{StaticResource MenuItemTemplate}"
                               ItemsSource="{Binding MenuItems}"
                               SelectedItem="{Binding SelectedStudent, Mode=TwoWay}"
                               OptionsItemsSource="{Binding MenuOptionItems}"
                               SelectedIndex="1"
                               HamburgerVisibility="Collapsed"
                               Grid.Column="0"
                               Style="{StaticResource PeoplesMenu}">

            </mah:HamburgerMenu>

            <mah:HamburgerMenu x:Name="DatesMenuControl"
                                   DisplayMode="CompactInline"
                                   IsPaneOpen="False"
                                   ItemTemplate="{StaticResource MenuItemTemplate}"
                                   ItemsSource="{Binding MenuDatesItems}"
                                   OptionsItemTemplate="{StaticResource MenuItemTemplate}"
                                   SelectedIndex="0"
                                   HamburgerVisibility="Collapsed"
                                   Grid.Column="1"
                               Style="{StaticResource DatesMenu}">
                <!--  select the ViewModel of the selected item (options item)  -->
                <mah:HamburgerMenu.Content>
                    <MultiBinding Converter="{StaticResource SelectedItemToContentConverter}">
                        <Binding FallbackValue="{x:Null}"
                                     Mode="OneWay"
                                     Path="SelectedItem"
                                     RelativeSource="{RelativeSource Self}" />
                        <Binding FallbackValue="{x:Null}"
                                     Mode="OneWay"
                                     Path="SelectedOptionsItem"
                                     RelativeSource="{RelativeSource Self}" />
                    </MultiBinding>
                </mah:HamburgerMenu.Content>
            </mah:HamburgerMenu>
        </Grid>
    </Border>
</Page>